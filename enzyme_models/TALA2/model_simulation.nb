(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14385,        328]
NotebookOptionsPosition[     13898,        306]
NotebookOutlinePosition[     14261,        322]
CellTagsIndexPosition[     14218,        319]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.639729139436756*^9, 3.639729140587323*^9}, {
  3.640093333126033*^9, 3.640093334996044*^9}, {3.64032346627951*^9, 
  3.640323466979537*^9}, {3.695129818290565*^9, 3.695129818760935*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "Toolbox`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "Toolbox`Style`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"enzModelsDir", " ", "=", " ", 
  "\"\</home/mrama/Dropbox/PhD_stuff/Projects/MD/eMASS-MD/enzyme_models/\>\""}\
], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mainDir", "=", 
   RowBox[{"enzModelsDir", "<>", "\"\<code_data/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", 
   RowBox[{"mainDir", "<>", "\"\<sim_plot_functions.m\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"mainDir", "<>", "\"\<simulation.m\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"enzKeq", "=", "0.762"}], ";"}]}], "Input",
 CellChangeTimes->{{3.64008138838286*^9, 3.640081388540393*^9}, {
  3.640637945732662*^9, 3.640637946633457*^9}, {3.6820560665901203`*^9, 
  3.682056067940817*^9}, {3.69365284050359*^9, 3.693652840770196*^9}, {
  3.693720355248662*^9, 3.69372035787155*^9}, {3.693720773420349*^9, 
  3.6937207792735243`*^9}, {3.6937584925757837`*^9, 3.693758492790125*^9}, {
  3.693759040490933*^9, 3.6937590496803627`*^9}, {3.693910853126341*^9, 
  3.693910858816224*^9}, {3.694103656789948*^9, 3.694103657452764*^9}, {
  3.6941897736239843`*^9, 3.6941897739961033`*^9}, {3.709551204138324*^9, 
  3.70955120540514*^9}, {3.718432527085966*^9, 3.718432532490848*^9}}],

Cell[CellGroupData[{

Cell["Simulations", "Section",
 CellChangeTimes->{{3.639732442084312*^9, 3.639732452084869*^9}, 
   3.639911928696864*^9, {3.639976497015728*^9, 3.6399764984297733`*^9}}],

Cell[CellGroupData[{

Cell["\<\

Systematic simulations\
\>", "Subsection",
 CellChangeTimes->{{3.639732442084312*^9, 3.639732452084869*^9}, 
   3.639911928696864*^9, 3.640078832561446*^9, {3.640507540458708*^9, 
   3.6405075459214153`*^9}, {3.6939111762641373`*^9, 3.693911188640924*^9}, 
   3.709440567855864*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParallelNeeds", "[", "\"\<Toolbox`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"enzName", "=", "\"\<TALA2\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inputDir", " ", "=", " ", 
   RowBox[{
   "enzModelsDir", "<>", " ", 
    "\"\<TALA2/TALA2_param_inf/output/model_simulations/models/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputDirBase", " ", "=", "  ", 
   RowBox[{
   "enzModelsDir", "<>", 
    "\"\<TALA2/TALA2_param_inf/output/model_simulations/data/\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", "outputDirBase", "]"}]}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"outputDirBase", ",", 
       RowBox[{"CreateIntermediateDirectories", "\[Rule]", " ", "True"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerConcMets", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<e4p\>\"", ",", " ", "\"\<f6p\>\"", ",", " ", "\"\<g3p\>\"", ",", 
     " ", "\"\<s7p\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerConcEnz", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<TALA2\>\"", ",", " ", "\"\<TALA2&f6p\>\"", ",", " ", 
     "\"\<TALA2&mod\>\"", ",", " ", "\"\<TALA2&pi\>\"", " ", ",", 
     "\"\<TALA2&s7p\>\"", " ", ",", "\"\<TALA2&mod&e4p\>\"", ",", " ", 
     "\"\<TALA2&mod&g3p\>\"", ",", " ", "\"\<TALA2&mod&pi\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headerFlux", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<v_tala21\>\"", ",", " ", "\"\<v_tala22\>\"", ",", " ", 
     "\"\<v_tala23\>\"", ",", " ", "\"\<v_tala24\>\"", ",", " ", 
     "\"\<v_tala25\>\"", ",", " ", "\"\<v_tala26\>\"", ",", " ", 
     "\"\<v_talainhib1\>\"", ",", " ", "\"\<v_talainhib2\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subInd", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"9", ",", "10"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prodInd", "=", 
   RowBox[{"{", 
    RowBox[{"11", ",", "13"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indEnz", "=", 
    RowBox[{"Range", "[", "8", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initCondList", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outputDirList", "=", 
    RowBox[{"{", "\"\<noPerturb\>\"", "}"}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tValues", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"10", "^", "#"}], "&"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "6"}], ",", "2", ",", " ", "0.1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tFinal", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tValues", "=", 
    RowBox[{"Insert", "[", 
     RowBox[{"tValues", ",", "0.", ",", " ", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelIDList", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<all\>\"", ",", " ", "\"\<dKd\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nModelEnsembles", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "99"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KeqVal", " ", "=", " ", "0.762"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LaunchKernels", "[", "2", "]"}], ";"}], "\[IndentingNewLine]", 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"outputDir", " ", "=", 
       RowBox[{"outputDirBase", "<>", 
        RowBox[{"outputDirList", "[", 
         RowBox[{"[", "initCondI", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "[", 
          RowBox[{"outputDir", "<>", "\"\</data_mx/\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{
          RowBox[{"outputDir", "<>", "\"\</data_mx/\>\""}], ",", 
          RowBox[{"CreateIntermediateDirectories", "\[Rule]", " ", "True"}]}],
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"simulateEnsemble", "[", 
          RowBox[{
          "inputDir", ",", " ", "outputDir", ",", " ", "enzName", ",", " ", 
           "modelID", ",", " ", "nModelEnsembles", ",", " ", "tFinal", ",", 
           " ", "tValues", ",", " ", 
           RowBox[{"initCondList", "[", 
            RowBox[{"[", "initCondI", "]"}], "]"}], ",", " ", "headerConcEnz",
            ",", " ", "headerConcMets", ",", " ", "headerFlux", ",", " ", 
           "indEnz", ",", "subInd", ",", " ", "prodInd", ",", " ", "KeqVal"}],
           "]"}], ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"modelID", ",", " ", "modelIDList"}], "}"}]}], "]"}], ";"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"initCondI", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "@", "initCondList"}]}], "}"}]}], "]"}], ";"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6931141099054537`*^9, 3.6931141140524397`*^9}, {
   3.6931283376338177`*^9, 3.693128338984435*^9}, {3.693130485594079*^9, 
   3.693130486107317*^9}, {3.693143724097723*^9, 3.693143731363471*^9}, {
   3.693654232625993*^9, 3.693654233359611*^9}, {3.693660279312521*^9, 
   3.693660358860836*^9}, {3.693661284498734*^9, 3.693661290510708*^9}, 
   3.693720326180655*^9, {3.6937227405587387`*^9, 3.6937227471019793`*^9}, {
   3.693723049888411*^9, 3.693723056250029*^9}, 3.69372312720647*^9, {
   3.6937232747780743`*^9, 3.6937232748189707`*^9}, {3.693724484062353*^9, 
   3.6937244924658213`*^9}, 3.693728507537588*^9, {3.6937289732274637`*^9, 
   3.693728973668762*^9}, {3.693758641971414*^9, 3.693758645215906*^9}, {
   3.693773775823036*^9, 3.6937737764523067`*^9}, {3.693807322188307*^9, 
   3.6938073291229763`*^9}, {3.693895244146391*^9, 3.69389524432445*^9}, {
   3.693896641285568*^9, 3.693896669958844*^9}, 3.6938967631507387`*^9, {
   3.6939009568632402`*^9, 3.693900957424221*^9}, {3.69391074540368*^9, 
   3.6939108454974546`*^9}, {3.693910876018834*^9, 3.693910888110783*^9}, {
   3.693911240583027*^9, 3.693911253499789*^9}, 3.6939112942057743`*^9, {
   3.693911439322836*^9, 3.693911443754962*^9}, {3.693911659167993*^9, 
   3.693911660572797*^9}, {3.693911788953985*^9, 3.693911885086644*^9}, 
   3.693911964962963*^9, {3.693912132217473*^9, 3.6939123067468853`*^9}, {
   3.6939123471902246`*^9, 3.693912354822456*^9}, {3.693912391569282*^9, 
   3.693912409816784*^9}, {3.6939124480849123`*^9, 3.6939124974456587`*^9}, {
   3.6939125512029037`*^9, 3.693912584356489*^9}, {3.6939127041861563`*^9, 
   3.6939127269325933`*^9}, 3.693912760385623*^9, {3.693913239675153*^9, 
   3.6939132416474743`*^9}, {3.6939167958598223`*^9, 3.693916799017457*^9}, {
   3.693921804988603*^9, 3.6939218351307364`*^9}, {3.693922039426382*^9, 
   3.693922090609489*^9}, {3.693922809403078*^9, 3.693922809702812*^9}, {
   3.693924233814748*^9, 3.6939242448146563`*^9}, {3.6939242880070887`*^9, 
   3.693924288282392*^9}, {3.693924433949136*^9, 3.693924441388578*^9}, {
   3.693924674077396*^9, 3.6939246793834743`*^9}, {3.693924788807687*^9, 
   3.693924806626183*^9}, {3.6939250822707376`*^9, 3.6939250868194103`*^9}, {
   3.6939251939102793`*^9, 3.6939252631561203`*^9}, 3.6939253745442057`*^9, {
   3.6939254163881598`*^9, 3.693925420697632*^9}, {3.6939263132632437`*^9, 
   3.6939263135441427`*^9}, 3.694103691616544*^9, {3.694103730942073*^9, 
   3.694103880323271*^9}, {3.6941039895960007`*^9, 3.6941039897242117`*^9}, {
   3.69415435684228*^9, 3.694154376534484*^9}, {3.6941780218902903`*^9, 
   3.694178041156541*^9}, {3.6941897948735113`*^9, 3.6941898224919567`*^9}, {
   3.694189861529924*^9, 3.694189918760088*^9}, {3.694190237223748*^9, 
   3.694190259119315*^9}, {3.694190302799099*^9, 3.694190324255989*^9}, {
   3.694190355181529*^9, 3.6941903676494713`*^9}, 3.694233800900182*^9, {
   3.694241296983374*^9, 3.6942413177291737`*^9}, {3.694243263149273*^9, 
   3.694243263829879*^9}, {3.69424329774266*^9, 3.6942433164651937`*^9}, {
   3.694244662391653*^9, 3.694244673908784*^9}, {3.6942448042496233`*^9, 
   3.6942448049776287`*^9}, {3.694244991419363*^9, 3.694244999478904*^9}, {
   3.694248515754692*^9, 3.694248515879236*^9}, {3.6942569528549356`*^9, 
   3.694256953009159*^9}, 3.694321024872506*^9, {3.6943231402139482`*^9, 
   3.694323143893037*^9}, {3.695119283349923*^9, 3.6951192883216467`*^9}, {
   3.6951201176461678`*^9, 3.695120121334581*^9}, {3.695125956984627*^9, 
   3.695126023659224*^9}, {3.6951261010805197`*^9, 3.695126107354947*^9}, {
   3.695128675915854*^9, 3.695128681590151*^9}, {3.6951408783983173`*^9, 
   3.695140897914865*^9}, 3.695190109907481*^9, {3.695543628598764*^9, 
   3.6955436496024923`*^9}, {3.695543718681551*^9, 3.6955437203820267`*^9}, {
   3.695543756958692*^9, 3.69554377205028*^9}, {3.695543861892564*^9, 
   3.695543869605288*^9}, {3.69554390506594*^9, 3.6955439091060343`*^9}, {
   3.6955481374544353`*^9, 3.695548142565936*^9}, {3.695548234140615*^9, 
   3.695548240740251*^9}, {3.6955483299916*^9, 3.6955483892772017`*^9}, {
   3.695558787752331*^9, 3.69555879051304*^9}, 3.6955593870075293`*^9, 
   3.695559441402203*^9, {3.7094405815787487`*^9, 3.709440587739058*^9}, {
   3.709440746207638*^9, 3.709440753334085*^9}, 3.709441554551927*^9, {
   3.7094417526543207`*^9, 3.709441765576399*^9}, {3.7094419778934517`*^9, 
   3.70944198743349*^9}, 3.709442077328247*^9, 3.709442222709422*^9, {
   3.709442461265773*^9, 3.709442464686468*^9}, {3.709442814816739*^9, 
   3.7094428160829687`*^9}, {3.709442996521307*^9, 3.7094429966363077`*^9}, 
   3.709443144724573*^9, {3.7094431897461653`*^9, 3.709443193113791*^9}, {
   3.709443311538067*^9, 3.709443332818104*^9}, {3.709551382097039*^9, 
   3.7095514061683817`*^9}, {3.7095514369897413`*^9, 
   3.7095515069520206`*^9}, {3.709551538755912*^9, 3.709551620382123*^9}, {
   3.7095517425550957`*^9, 3.709551790225156*^9}, {3.709624692493678*^9, 
   3.709624695540269*^9}, {3.709637589776507*^9, 3.709637592167123*^9}, {
   3.7184325498616257`*^9, 3.718432594113302*^9}}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Local2",
WindowSize->{1136, 765},
WindowMargins->{{679, Automatic}, {Automatic, 124}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 261, 4, 32, "Input"],
Cell[822, 26, 1591, 34, 237, "Input"],
Cell[CellGroupData[{
Cell[2438, 64, 170, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[2633, 70, 293, 7, 70, "Subsection"],
Cell[2929, 79, 10941, 223, 1120, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

